# API для кеширования данных о погоде

## Введение

Работает с внешним API [Open-Meteo](https://open-meteo.com/). Запрашивает данные о погоде с переданными долготой и широтой требуемого местоположения, для которого необходимо узнать погоду, с сохранением данных в кеш. Ключ кеша состоит из широты и долготы, а также временной метки, которая округляется до часа. Таким образом, данные о погоде для каждого местоположения будут актуальны в кеше в течение часа.

### Пример запроса на внешний API

```bash
curl "https://api.open-meteo.com/v1/forecast?latitude=52.52&longitude=13.41&current=temperature_2m,wind_speed_10m&hourly=temperature_2m,relative_humidity_2m,wind_speed_10m"
```

### Пример ответа

```json
{
  "current": {
    "time": "2022-01-01T15:00",
    "temperature_2m": 2.4,
    "wind_speed_10m": 11.9,
  },
  "hourly": {
    "time": ["2022-07-01T00:00", "2022-07-01T01:00", "2022-07-01T02:00"],
    "wind_speed_10m": [3.16, 3.02, 3.3],
    "temperature_2m": [13.7, 13.3, 12.8],
    "relative_humidity_2m": [82, 83, 86]
  }
}
```

## Установка и запуск

```bash
npm i
npm run start
```

## ESLint

Найти и исправить проблемы в коде с помощью ESLint:

```bash
npm run lint-fix
```

## Порядок работы

Подробное описание методов можно найти в [онлайн-документации Swagger](http://localhost:3000/docs) (проект должен быть запущен).

### Сценарий тестирования

1. Установить размер кеша в `3` элемента: `POST /api/weather/cache/size { "size": 3 }`
2. Получить данные:
  - Для Москвы: `GET /api/weather?latitude=55.75&longitude=37.6`. Загрузка выполняется ощутимо долго, т.к. данных в кеше еще нет.
    - Повторное выполнение метода происходит почти мгновенно, т.к. данные берутся уже из кеша.
    - Проверяем размер кеша: `/api/weather/cache/status`: `{ "size": 1, "maxSize": 3 }`.
  - Для Иваново: `GET /api/weather?latitude=57&longitude=41`. Загрузка выполняется ощутимо долго, т.к. данных в кеше еще нет.
    - Повторное выполнение метода происходит почти мгновенно, т.к. данные берутся уже из кеша.
    - Проверяем размер кеша: `/api/weather/cache/status`: `{ "size": 2, "maxSize": 3 }`.
  - Для Нью-Йорка: `GET /api/weather?latitude=40.72&longitude=-74`. Загрузка выполняется ощутимо долго, т.к. данных в кеше еще нет.
    - Повторное выполнение метода происходит почти мгновенно, т.к. данные берутся уже из кеша.
    - Проверяем размер кеша: `/api/weather/cache/status`: `{ "size": 3, "maxSize": 3 }`.
    - На данном этапе кеш полностью заполнен. Последующие запросы новых данных из внешнего API будут приводить к удалению старых данных из кеша.
  - Для Лондона: `GET /api/weather?latitude=51.5&longitude=-0.1`.
    - На данном этапе происходит переполнение кеша и первый элемент удаляется (для Москвы).
    - В этом можно убедиться, запросив еще раз погоду для Москвы: `GET /api/weather?latitude=55.75&longitude=37.6`. Загрузка выполняется ощутимо долго, т.к. данных в кеше уже нет.
    - Проверяем размер кеша: `/api/weather/cache/status`: `{ "size": 3, "maxSize": 3 }`.
3. Очистить кеш: `DELETE /api/weather/cache`
  - Проверяем размер кеша: `/api/weather/cache/status`: `{ "size": 0, "maxSize": 3 }`.

# Вступительное задание для Backend специалиста

## Задача

Ваша задача - продумать и разработать структуру API для кеширования данных на серверной части, а также контроля над кешем. Вы должны выбрать API из данного списка: [Public APIs](https://github.com/public-apis/public-apis#books-ov-file). Реализуйте in-memory кеш, который позволит приложению при запросе к API сначала проверить, имеются ли данные в кеше, и выполнять запрос только в том случае, если данные в кеше отсутствуют. Также, реализуйте методы очистки кеша и изменения размера кеша.

## Требования

1. Работоспособность приложения.

### Дополнительные пункты

2. Покрытие API документацией с помощью Swagger.
3. Построение архитектуры проекта с делением его на слои.

## Инструменты для проверки качества кода

1. [ESLint](https://eslint.org/) - инструмент для проверки и исправления проблем в коде на основе настраиваемых правил.
2. [Prettier](https://prettier.io/) - инструмент для форматирования кода согласно стандартам и кодстайлу.


## Порядок выполнения

1. Изучите список доступных API и выберите одно из них для реализации кеша.
2. Форкните данный репозиторий с заготовкой проекта, и создайте новый проект на Node.js с использованием Express в своем форкнутом репозитории, развивая имеющуюся заготовку.
3. Реализуйте in-memory кеш с методами для проверки наличия данных, добавления новых данных, очистки кеша и изменения размера кеша.
4. Разработайте API-маршруты для поддержки кеша: получение данных с проверкой наличия в кеше, обновление данных, очистка кеша и изменение размера кеша.
5. (Дополнительно) Реализуйте поддержку документации для вашего API с помощью Swagger.
6. (Дополнительно) Организуйте проект таким образом, чтобы соблюдалась архитектура с делением на слои.
7. Предоставьте ссылку на форкнутый репозиторий.

## Оценка

Ваша работа будет оцениваться по следующим критериям:

1. Работоспособность вашего приложения и корректное выполнение всех требуемых функций кеша.
2. (Дополнительно) Качество документации API с использованием Swagger: полнота и ясность описания всех маршрутов и параметров.
3. (Дополнительно) Архитектура проекта и деление на слои: организация кода, модульность и четкое разделение функций между различными частями приложения.

Мы желаем вам успехов в выполнении задания и рады будем видеть вас в числе наших студентов!